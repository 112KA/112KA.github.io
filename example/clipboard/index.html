<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Clipboard test</title>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script>
    $(function () {

    var textarea = $('textarea')[0]
    textarea.addEventListener('paste', e => {
      e.preventDefault()
      console.log(e.clipboardData)

    navigator.clipboard.read().then(async (data) => {
      // console.log('data', data)
      for (var i = 0; i < data.length; i++) {
        // if (data[i].types.indexOf('text/plain') !== -1) {
        //     // console.log(data[i].getAs('text/plain'))
        //   const blob = await data[0].getType('text/plain');
        //   const text = await blob.text();
        //   console.log(text)
        // }
        
        if (data[i].types.indexOf('text/html') !== -1) {
            // console.log(data[i].getAs('text/html'))
          const blob = await data[0].getType('text/html');
          const text = await blob.text();
          console.log(text)
          $(textarea).text(text)
        }

        //  else {
        //     console.error('テキストではありません…');
        // }
      }
    });
    });
    })
  </script>
</head>
<body>
  <h1>Wordの文章を貼り付けるとhtmlとして表示する</h1>
  <textarea style="width:50%; height:300px;"></textarea>
</body>
</html>